{"timestamp": 1698744592.585962, "stored_source_code": "# add default values for parameters here\n# XY Spin Chain\nWe introduce here a new mode of interaction between the atoms driven by the dipole-dipole interaction. This mode is called the XY mode. The interaction hamiltonian of a system of $N$ qubits is now given by \n\n$$\nH_{XY} = \\sum_{i=1}^N\\sum_{j<i} \\frac{C_3}{R_{ij}^3}(\\sigma^+_i \\sigma^-_j + \\sigma^-_i \\sigma^+_j) \n$$\n\nwhere $\\sigma^{\u00b1} = (\\sigma^x \u00b1 i\\sigma^y)/2$, $R_{ij}$ is the distance between atom $i$ and atom $j$, and $C_3$ is a coefficient dependent on the device and taken as  $\\frac{C_3}{\\hbar} = 3700 \\mu m^3/\\mu s$ for the `MockDevice`.\n\nThe final hamiltonian of the system is \n\n$$\nH= \\sum_{i=1}^N \\frac{\\hbar\\Omega}{2} \\sigma_i^x - \\sum_{i=1}^N \\frac{\\hbar \\delta}{2}  \\sigma_i^z+H_{XY}.\n$$\n\nThe Rydberg states involved are different from the ones of the Ising interaction, they are $|0\\rangle = |62D_{3/2}, m_j=3/2 \\rangle$ and $|1\\rangle = |63P_{1/2}, m_j=1/2 \\rangle$. \n\n\nMore details on the XY mode can be found in the following reference: [Barredo et al. 2014](https://arxiv.org/pdf/1408.1055.pdf)\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport qutip\n\nimport pulser\nfrom pulser import Pulse, Sequence, Register\nfrom pulser_simulation import QutipEmulator\nfrom pulser.devices import MockDevice\nfrom pulser.waveforms import BlackmanWaveform\n## Rabi oscillations of 1 atom\nWe start by showing Rabi oscillation in the XY mode in the case of a unique atom as shown in the figure 1 (c) of the [reference](https://arxiv.org/pdf/1408.1055.pdf). In a similar way as the Ising mode, the atom will oscillate between the two energy levels. The XY mode is only available in the `mw_global` channel. We initialize the register and instantiate the channel. \ncoords = np.array([[0, 0]])\nqubits = dict(enumerate(coords))\n\nreg = Register(qubits)\nseq = Sequence(reg, MockDevice)\nseq.declare_channel(\"MW\", \"mw_global\")\nWe then add a simple constant rabi pulse of amplitude $2\\pi \\times 4.6$ MHz and run the simulation. The measurement is necessarily done in the `XY` basis.\nsimple_pulse = Pulse.ConstantPulse(4000, 2 * np.pi * 4.6, 0, 0)\nseq.add(simple_pulse, \"MW\")\nseq.measure(basis=\"XY\")\n\nsim = QutipEmulator.from_sequence(seq)\n\nresults = sim.run(progress_bar=True, nsteps=5000)\nWe plot the expectation of the excitation of the atom over the time.\ndef excitation(j, total_sites):\n    \"\"\"The |1><1| projector operator on site j.\"\"\"\n    prod = [qutip.qeye(2) for _ in range(total_sites)]\n    prod[j] = (qutip.qeye(2) - qutip.sigmaz()) / 2\n    return qutip.tensor(prod)\n\n\nexcited = excitation(0, 1)\nplt.figure(figsize=[16, 6])\nresults.plot(excited)\nplt.xlabel(\"Pulse duration (ns)\", fontsize=\"x-large\")\nplt.ylabel(\"Excitation of the atom\", fontsize=\"x-large\")\nplt.show()\n## Spin chain of 3 atoms\nWe now simulate the free evolution of a spin chain of 3 atoms, starting with 1 excitation in the initial state $|100\\rangle$ as shown in the figure 3 (c) of the [reference](https://arxiv.org/pdf/1408.1055.pdf). \ncoords = np.array([[-8.0, 0], [0, 0], [8.0, 0]])\nqubits = dict(enumerate(coords))\n\nreg = Register(qubits)\nseq = Sequence(reg, MockDevice)\nseq.declare_channel(\"ch0\", \"mw_global\")\nreg.draw()\n\n# State preparation using SLM mask\nmasked_qubits = [1, 2]\nseq.config_slm_mask(masked_qubits)\nmasked_pulse = Pulse.ConstantDetuning(BlackmanWaveform(200, np.pi), 0, 0)\nseq.add(masked_pulse, \"ch0\")\n\n# Simulation pulse\nsimple_pulse = Pulse.ConstantPulse(7000, 0, 0, 0)\nseq.add(simple_pulse, \"ch0\")\nseq.measure(basis=\"XY\")\n\nsim = QutipEmulator.from_sequence(seq, sampling_rate=1)\nresults = sim.run(nsteps=5000)\nexcited_list = [excitation(j, 3) for j in range(3)]\n\nexpectations = results.expect(excited_list)\n\nplt.figure(figsize=[16, 18])\nplt.subplot(311)\nplt.plot(expectations[0])\nplt.ylabel(\"Excitation of atom 0\", fontsize=\"x-large\")\nplt.xlabel(\"Time (ns)\", fontsize=\"x-large\")\nplt.subplot(312)\nplt.plot(expectations[1])\nplt.ylabel(\"Excitation of atom 1\", fontsize=\"x-large\")\nplt.xlabel(\"Time (ns)\", fontsize=\"x-large\")\nplt.ylim([0, 1])\nplt.subplot(313)\nplt.plot(expectations[2])\nplt.ylabel(\"Excitation of atom 2\", fontsize=\"x-large\")\nplt.xlabel(\"Time (ns)\", fontsize=\"x-large\")\nplt.show()\n## External field and angular dependency\nAn external magnetic field can be added to the experiment, and will modify the hamiltonian. The XY Hamiltonian is then\n\n$$\nH_{XY} = \\sum_{i=1}^N\\sum_{j<i} \\frac{C_3[1 - 3\\text{cos}^2(\\theta_{ij})]}{R_{ij}^3}(\\sigma^+_i \\sigma^-_j + \\sigma^-_i \\sigma^+_j)\n$$\n\nwhere $\\theta_{ij}$ is the angle between the vector of the two atoms and the external field as shown on the figure below.\n\n<center>\n<img src=\"attachment:angular_dependency.png\" alt=\"Angular dependency\" width=\"300\">\n</center>\n\nWe add an external field along the Y axis, and we put the qubit 2 at the angle such that $\\text{cos}^2(\\theta_{12}) = 1/3$, and the interaction between the qubits 1 and 2 cancels out. This is done by the method `set_magnetic_field`from the `Sequence`.\n\nThis is the principle that enables to create [topological phases](https://science.sciencemag.org/content/365/6455/775) on long chain of atoms.\ncoords = np.array([[-1.0, 0], [0, 0], [np.sqrt(2 / 3), np.sqrt(1 / 3)]]) * 8.0\nqubits = dict(enumerate(coords))\n\nreg = Register(qubits)\nseq = Sequence(reg, MockDevice)\nseq.declare_channel(\"ch0\", \"mw_global\")\nseq.set_magnetic_field(0.0, 1.0, 0)\nreg.draw()\nWe then simulate again the free evolution from the initial state $|100\\rangle$. \n# State preparation using SLM mask\nmasked_qubits = [1, 2]\nseq.config_slm_mask(masked_qubits)\nmasked_pulse = Pulse.ConstantDetuning(BlackmanWaveform(200, np.pi), 0, 0)\nseq.add(masked_pulse, \"ch0\")\n\n# Simulation pulse\nsimple_pulse = Pulse.ConstantPulse(7000, 0, 0, 0)\nseq.add(simple_pulse, \"ch0\")\nseq.measure(basis=\"XY\")\n\nsim = QutipEmulator.from_sequence(seq, sampling_rate=1)\nresults = sim.run(progress_bar=True, nsteps=5000)\nexcited_list = [excitation(j, 3) for j in range(3)]\n\nexpectations = results.expect(excited_list)\n\nplt.figure(figsize=[16, 18])\nplt.subplot(311)\nplt.plot(expectations[0])\nplt.ylabel(\"Excitation of atom 0\", fontsize=\"x-large\")\nplt.xlabel(\"Time ($\\mu$s)\", fontsize=\"x-large\")\nplt.ylim([0, 1])\nplt.subplot(312)\nplt.plot(expectations[1])\nplt.ylabel(\"Excitation of atom 1\", fontsize=\"x-large\")\nplt.xlabel(\"Time ($\\mu$s)\", fontsize=\"x-large\")\nplt.ylim([0, 1])\nplt.subplot(313)\nplt.plot(expectations[2])\nplt.ylabel(\"Excitation of atom 2\", fontsize=\"x-large\")\nplt.xlabel(\"Time ($\\mu$s)\", fontsize=\"x-large\")\nplt.ylim([0, 1])\nplt.show()\nWe can see there that there is almost no excitation in the qubit 2. It still remains some because the interaction between the qubits 0 and 2 is not completely negligible.", "params": {}}